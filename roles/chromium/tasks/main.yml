---
  - name: Install chromium
    dnf: name=chromium state=present
  - name: Create temp dir for extracting plugins
    file: path=/tmp/chromium_plugins state=directory
  - name: Download Google Chrome (with plugins)
    get_url: url=https://dl.google.com/linux/direct/google-chrome-stable_current_{{ ansible_architecture }}.rpm dest=/tmp/chromium_plugins/google-chrome-stable_current_{{ ansible_architecture }}.rpm
  - name: Unpack Google Chrome rpm
    shell: "rpm2cpio google-chrome-stable_current_{{ ansible_architecture }}.rpm | cpio -idmv"
    args:
      chdir: /tmp/chromium_plugins/
      creates: /tmp/chromium_plugins/opt/google/chrome/PepperFlash/
  - name: Copy PepperFlash
    shell: "rsync -a /tmp/chromium_plugins/opt/google/chrome/PepperFlash/ /usr/lib64/chromium-browser/PepperFlash/"
  - name: Copy Widevine
    shell: "rsync -a /tmp/chromium_plugins/opt/google/chrome/libwidevinecdm* /usr/lib64/chromium-browser/"
  - name: Remove temp dir
    file: path=/tmp/chromium_plugins state=absent

